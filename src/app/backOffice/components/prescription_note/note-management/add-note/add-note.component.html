<br/>
<br/>
<br/>
<br/>
<br/>
<br/>

<div class="relative flex flex-col min-w-0 break-words w-full mb-6 shadow-lg rounded p-4"
  [ngClass]="color === 'light' ? 'bg-white' : 'bg-red-900 text-white'">
  <div class="mb-10">
    <h2 class="text-4xl font-bold text-gray-800 mb-2">New Clinical Note</h2>
    <p class="text-gray-500">Fill out the following details to add a new patient note.</p>
  </div>

  <form [formGroup]="noteForm" (ngSubmit)="onSubmit()" class="space-y-8">
    <div class="form-group">
      <label class="block text-sm font-medium text-gray-700 mb-1">Patient *</label>
      <div class="relative">
        <select formControlName="patient"
          class="w-full px-4 py-3 border rounded-lg border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          <option value="" disabled selected>Select a patient</option>
          <option *ngFor="let patient of patientList" [ngValue]="patient">
            {{ patient.username }}
          </option>
        </select>
        <p *ngIf="noteForm.get('patient')?.touched && noteForm.get('patient')?.invalid"
          class="text-red-500 text-xs mt-1">
          Patient is required.
        </p>
      </div>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="form-group">
        <label class="block text-sm font-medium text-gray-700 mb-1">Diagnosis *</label>
        <input formControlName="diagnosis" type="text" placeholder="e.g. Type 2 diabetes"
          class="w-full px-4 py-3 border rounded-lg border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
        <p *ngIf="noteForm.get('diagnosis')?.touched && noteForm.get('diagnosis')?.invalid"
          class="text-red-500 text-xs mt-1">
          Diagnosis is required.
        </p>
      </div>
      <div class="form-group">
        <label class="block text-sm font-medium text-gray-700 mb-1">Expiration Date *</label>
        <input type="date" formControlName="expirationDate"
          class="w-full px-4 py-3 border rounded-lg border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
        <p *ngIf="noteForm.get('expirationDate')?.touched && noteForm.get('expirationDate')?.invalid"
          class="text-red-500 text-xs mt-1">
          Expiration date is required.
        </p>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Clinical Observations</label>
        <textarea formControlName="notes" placeholder="Detailed patient assessment..."
          class="w-full px-4 py-3 h-48 border rounded-lg border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Treatment Guidance</label>
        <textarea formControlName="guidance" placeholder="Patient care instructions..."
          class="w-full px-4 py-3 h-32 border rounded-lg border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea>
      </div>
    </div>

    <div class="pt-6">
      <button [disabled]="noteForm.invalid || isLoading"
        class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-xs" type="submit">{{isLoading ?
        "Loading...":"Add Note"}}</button>
    </div>
  </form>
</div>
