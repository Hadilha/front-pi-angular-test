<div class="relative flex flex-col min-w-0 break-words w-full mb-6 shadow-lg rounded"
  [ngClass]="color === 'light' ? 'bg-white' : 'bg-red-900 text-white'">
  <div class="rounded-t mb-0 px-4 py-3 border-0">
    <div class="flex items-center justify-between">
      <h3 class="font-semibold text-lg" [ngClass]="color === 'light' ? 'text-blueGray-700' : 'text-white'">
        Prescription List
      </h3>
      <div class="flex items-center">
        <!-- Notification Bell -->
        <div class="relative notification-bell mr-4" (click)="toggleNotificationList()">
          <i class="fas fa-bell text-gray-500 cursor-pointer hover:text-blue-500 transition-colors" 
             [ngClass]="unreadCount > 0 ? 'text-blue-500' : ''"></i>
          <div *ngIf="unreadCount > 0" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center shadow-lg">
            {{ unreadCount }}
          </div>
        </div>
        
        <!-- Notification Dropdown -->
        <div *ngIf="showNotifications" class="absolute top-12 right-0 bg-white shadow-xl rounded-lg w-80 z-50 notification-dropdown">
          <div class="p-3 border-b border-gray-200 flex justify-between items-center">
            <h4 class="font-bold text-lg text-gray-700">Notifications</h4>
            <button *ngIf="notifications.length > 0" (click)="clearAllNotifications()" 
                    class="text-xs text-gray-500 hover:text-red-500 transition-colors">
              Clear all
            </button>
          </div>
          
          <div class="max-h-96 overflow-y-auto">
            <div *ngIf="notifications.length === 0" class="text-gray-500 text-sm p-4 text-center">
              No notifications
            </div>
            
            <div *ngFor="let notification of notifications; let i = index" 
                 class="notification-item p-3 border-b border-gray-100 last:border-0 hover:bg-gray-50 transition-colors cursor-pointer"
                 [ngClass]="{'bg-blue-50': !notification.read}"
                 (click)="markAsRead(notification)">
              <div class="flex justify-between items-start">
                <div class="flex-1">
                  <div class="flex items-center gap-2">
                    <i class="fas fa-prescription text-orange-500"></i>
                    <div [ngClass]="{'font-semibold': !notification.read}" class="text-sm text-gray-800">
                      {{ notification.message }}
                    </div>
                  </div>
                  <div class="mt-1 text-xs text-gray-400">
                    {{ notification.timestamp | date:'MMM d, y, h:mm a' }}
                  </div>
                </div>
                <button (click)="deleteNotification(i); $event.stopPropagation()" 
                        class="text-gray-400 hover:text-red-500 transition-colors">
                  <i class="fas fa-times"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <button class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-xs ml-4 transition-colors" (click)="navigateToCreate()">
          Add Prescription
        </button>
      </div>
    </div>
  </div>

  <div class="block w-full overflow-x-auto">
    <table class="items-center w-full bg-transparent border-collapse">
      <thead>
        <tr>
          <th class="px-6 py-3 text-xs uppercase font-semibold text-left border border-solid border-l-0 border-r-0"
            [ngClass]="color === 'light' ? 'bg-blueGray-50 text-blueGray-500 border-blueGray-100' : 'bg-red-800 text-red-300 border-red-700'">
            #
          </th>
          <th class="px-6 py-3 text-xs uppercase font-semibold text-left border border-solid border-l-0 border-r-0"
            [ngClass]="color === 'light' ? 'bg-blueGray-50 text-blueGray-500 border-blueGray-100' : 'bg-red-800 text-red-300 border-red-700'">
            Doctor
          </th>
          <th class="px-6 py-3 text-xs uppercase font-semibold text-left border border-solid border-l-0 border-r-0"
            [ngClass]="color === 'light' ? 'bg-blueGray-50 text-blueGray-500 border-blueGray-100' : 'bg-red-800 text-red-300 border-red-700'">
            Patient
          </th>
          <th class="px-6 py-3 text-xs uppercase font-semibold text-left border border-solid border-l-0 border-r-0"
            [ngClass]="color === 'light' ? 'bg-blueGray-50 text-blueGray-500 border-blueGray-100' : 'bg-red-800 text-red-300 border-red-700'">
            Diagnosis
          </th>
          <th class="px-6 py-3 text-xs uppercase font-semibold text-left border border-solid border-l-0 border-r-0"
            [ngClass]="color === 'light' ? 'bg-blueGray-50 text-blueGray-500 border-blueGray-100' : 'bg-red-800 text-red-300 border-red-700'">
            Created
          </th>
          <th class="px-6 py-3 text-xs uppercase font-semibold text-left border border-solid border-l-0 border-r-0"
            [ngClass]="color === 'light' ? 'bg-blueGray-50 text-blueGray-500 border-blueGray-100' : 'bg-red-800 text-red-300 border-red-700'">
            Expires
          </th>
          <th class="px-6 py-3 text-xs uppercase font-semibold text-left border border-solid border-l-0 border-r-0"
            [ngClass]="color === 'light' ? 'bg-blueGray-50 text-blueGray-500 border-blueGray-100' : 'bg-red-800 text-red-300 border-red-700'">
            Actions
          </th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let p of prescriptions; let index = index">
          <td class="border-t-0 px-6 py-4 text-xs whitespace-nowrap">{{ index+1 }}</td>
          <td class="border-t-0 px-6 py-4 text-xs whitespace-nowrap">{{ p.doctor.fullName }}</td>
          <td class="border-t-0 px-6 py-4 text-xs whitespace-nowrap">{{ p.patient.fullName }}</td>
          <td class="border-t-0 px-6 py-4 text-xs whitespace-nowrap">{{ p.diagnosis }}</td>
          <td class="border-t-0 px-6 py-4 text-xs whitespace-nowrap">{{ p.creationDate | date: 'dd/MM/yyyy' }}</td>
          <td class="border-t-0 px-6 py-4 text-xs whitespace-nowrap">{{ p.expirationDate | date: 'dd/MM/yyyy' }}</td>
          <td class="border-t-0 px-6 py-4 text-xs whitespace-nowrap">
            <div class="flex space-x-4">
              <button class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-xs"
                (click)="navigateToDetails(p.id)">DÃ©tails</button>
              <button class="bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-1 rounded text-xs"
                (click)="navigateToUpdate(p)">Update</button>
              <button class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-xs"
                (click)="deletePrescription(p.id)">Delete</button>
              <button class="bg-indigo-500 hover:bg-indigo-600 text-white px-3 py-1 rounded text-xs"
                (click)="generatePrescriptionPDF(p)">Save</button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<div class="w-full">
 
  <div class="relative flex flex-col min-w-0 break-words bg-white shadow-lg rounded">
    <div class="rounded-t mb-0 px-4 py-3 bg-transparent">
      <div class="flex items-center">
        <div class="flex-grow">
          <h6 class="uppercase text-blueGray-400 mb-1 text-xs font-semibold">Performance</h6>
          <h2 class="text-blueGray-700 text-xl font-semibold">Age chart</h2>
        </div>
      </div>
    </div>
    <div class="p-4 flex-auto">
      <div class="relative" style="height: 350px">
        <canvas id="bar-chart" width="400" height="350"></canvas>
      </div>
    </div>
  </div>
</div>