<app-patient-navbar></app-patient-navbar>

<main>
  <!-- Hero Section -->
  <section
    class="relative pt-24 pb-32 flex items-center justify-center min-h-screen-75"
  >
  <div
  class="absolute top-0 w-full h-full bg-cover bg-center"
  style="background-image: url('/assets/img/Mohamed.jpg');"
  >


      <span class="w-full h-full absolute bg-black opacity-70"></span>
    </div>
    <div class="relative z-10 text-center px-6">
      <h1 class="text-4xl md:text-5xl font-bold text-white">
        Personalized Wellness Content for You
      </h1>
      <p class="mt-4 text-lg text-blueGray-200 max-w-xl mx-auto">
        Discover helpful videos, articles, and media that support your mental
        well-being — handpicked with care.
      </p>
    </div>
    <div
      class="absolute bottom-0 left-0 right-0 overflow-hidden h-20 pointer-events-none"
    >
      <svg
        class="absolute bottom-0"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 2560 100"
        preserveAspectRatio="none"
      >
        <polygon
          class="text-blueGray-200 fill-current"
          points="2560 0 2560 100 0 100"
        ></polygon>
      </svg>
    </div>
  </section>

  <!-- Content Section -->
  <section class="bg-blueGray-100 py-12">
    <div class="max-w-7xl mx-auto px-4">
      <!-- Loading -->
      <div *ngIf="isLoading" class="text-center py-10">
        <div
          class="inline-block animate-spin h-10 w-10 border-4 border-t-transparent border-blue-600 rounded-full"
        ></div>
        <p class="mt-4 text-blueGray-500 text-sm">Loading content...</p>
      </div>

      <!-- Content Cards -->
      <div
        *ngIf="!isLoading && programContents.length > 0"
        class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6"
      >
        <div
          *ngFor="let content of programContents"
          class="bg-white rounded-2xl shadow-md hover:shadow-lg transition duration-300 border border-blueGray-200"
        >
          <div class="p-5">
            <h3
              class="text-lg font-semibold text-blueGray-800 mb-2 line-clamp-1"
            >
              {{ content.title }}
            </h3>
            <p class="text-sm text-blueGray-600 mb-3 line-clamp-2">
              {{ content.contentDesc }}
            </p>

            <div
              [ngSwitch]="content.mediaType"
              class="rounded overflow-hidden mb-4 aspect-w-16 aspect-h-9"
            >
              <iframe
                *ngSwitchCase="'iframe'"
                [src]="getSafeMediaUrl(content.mediaLink, content.mediaType)"
                class="w-full h-full"
                frameborder="0"
                allowfullscreen
              ></iframe>

              <video
                *ngSwitchCase="'video'"
                controls
                class="w-full h-full object-cover"
              >
                <source [src]="content.mediaLink" type="video/mp4" />
              </video>

              <img
                *ngSwitchCase="'image'"
                [src]="content.mediaLink"
                [alt]="content.title"
                class="w-full h-full object-cover"
              />
            </div>

            <button
              (click)="toggleFeedbackForm(content)"
              class="w-full bg-blueGray-600 hover:bg-blue-700 text-white font-medium py-2 rounded-md transition duration-200"
            >
              Leave Feedback
            </button>

            <!-- Inline Feedback Form -->
            <div
              *ngIf="showFeedbackForm && selectedContent?.id === content.id"
              class="mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4"
            >
              <form (ngSubmit)="submitFeedback()" class="space-y-3">
                <div>
                  <label class="block text-sm font-medium text-blueGray-700 mb-1"
                    >Rating (1–5):</label
                  >
                  <input
                    type="number"
                    [(ngModel)]="feedback.rating"
                    name="rating"
                    min="1"
                    max="5"
                    required
                    class="w-full border rounded-md px-3 py-2 text-sm border-blueGray-300 focus:ring-2 focus:ring-blue-500 focus:outline-none"
                  />
                </div>

                <div>
                  <label class="block text-sm font-medium text-blueGray-700 mb-1"
                    >Comment:</label
                  >
                  <textarea
                    [(ngModel)]="feedback.comment"
                    name="comment"
                    required
                    rows="3"
                    class="w-full border rounded-md px-3 py-2 text-sm border-blueGray-300 focus:ring-2 focus:ring-blue-500 focus:outline-none"
                  ></textarea>
                </div>

                <div class="flex justify-end gap-2">
                  <button
                    type="button"
                    (click)="showFeedbackForm = false"
                    class="px-4 py-2 text-sm rounded-md border border-blueGray-300 text-blueGray-700 hover:bg-blueGray-100"
                  >
                    Cancel
                  </button>
                  <button
                    type="submit"
                    class="px-4 py-2 text-sm bg-blueGray-600 text-white rounded-md hover:bg-blue-700"
                  >
                    Submit
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</main>

<app-footer></app-footer>
